<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Authority Dashboard - Delhi Waterlogging</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <div class="logo" onclick="location.href='index.html'">
            <img src="logo.png" alt="URRS Logo">
            <h1>Urban Rain Resilience System (URRS)</h1>
        </div>
        <nav>
            <ul>
                <li><a href="live-map.html">Live Map</a></li>
                <li><a href="#" onclick="logout()">Logout</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <!-- Dashboard Stats -->
        <div class="stats-grid"
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 2rem; margin-bottom: 2rem;">
            <div class="card" style="text-align: center; padding: 1.5rem; border-left: 4px solid var(--primary-blue);">
                <h3 id="stat-total" style="font-size: 2rem; color: var(--primary-blue); margin-bottom: 0.5rem;">--</h3>
                <p style="color: var(--text-secondary); font-weight: 500;">Total Reports</p>
            </div>
            <div class="card" style="text-align: center; padding: 1.5rem; border-left: 4px solid #ef4444;">
                <h3 id="stat-pending" style="font-size: 2rem; color: #ef4444; margin-bottom: 0.5rem;">--</h3>
                <p style="color: var(--text-secondary); font-weight: 500;">Critical Pending</p>
            </div>
            <div class="card" style="text-align: center; padding: 1.5rem; border-left: 4px solid #f59e0b;">
                <h3 id="stat-process" style="font-size: 2rem; color: #f59e0b; margin-bottom: 0.5rem;">--</h3>
                <p style="color: var(--text-secondary); font-weight: 500;">In Progress</p>
            </div>
            <div class="card" style="text-align: center; padding: 1.5rem; border-left: 4px solid #16a34a;">
                <h3 id="stat-resolved" style="font-size: 2rem; color: #16a34a; margin-bottom: 0.5rem;">--</h3>
                <p style="color: var(--text-secondary); font-weight: 500;">Resolved Cases</p>
            </div>
        </div>

        <h2>Report Management Console</h2>
        <div class="card" style="background: #f8f9fa;">
            <div class="grid-2" style="grid-template-columns: 2fr 1fr 1fr; gap: 10px;">
                <div>
                    <label>Filter by Authority</label>
                    <select id="filter-authority">
                        <option value="">All Authorities</option>
                    </select>
                </div>
                <div>
                    <label>Status</label>
                    <select id="filter-status">
                        <option value="">All Status</option>
                        <option value="Open">Open</option>
                        <option value="In Progress">In Progress</option>
                        <option value="Resolved">Resolved</option>
                    </select>
                </div>
                <div style="display: flex; align-items: flex-end;">
                    <button onclick="loadReports()" class="btn btn-primary" style="width: 100%;">Apply Filter</button>
                </div>
            </div>
        </div>

        <div id="reports-table-container">
            <table style="width: 100%; border-collapse: collapse; background: white; margin-top: 1rem;">
                <thead>
                    <tr style="background: var(--primary-color); color: white;">
                        <th style="padding: 12px; text-align: left;">ID</th>
                        <th style="padding: 12px; text-align: left;">Title</th>
                        <th style="padding: 12px; text-align: left;">Severity</th>
                        <th style="padding: 12px; text-align: left;">Authority</th>
                        <th style="padding: 12px; text-align: left;">Status</th>
                        <th style="padding: 12px; text-align: left;">Action</th>
                    </tr>
                </thead>
                <tbody id="reports-tbody">
                    <!-- Reports will be injected here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Resolution Modal -->
    <div id="resolve-modal" class="modal-overlay"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(4px);">
        <div class="modal-content"
            style="background: white; padding: 2.5rem; border-radius: 1rem; width: 90%; max-width: 500px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); animation: slideUp 0.3s ease;">
            <h3 style="margin-bottom: 0.5rem; color: #1e293b; font-size: 1.5rem;">Mark as Resolved</h3>
            <p style="color: #64748b; margin-bottom: 2rem; font-size: 0.95rem;">Please provide details about the
                resolution action taken.</p>

            <div style="margin-bottom: 1.5rem;">
                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #334155;">Resolution
                    Note</label>
                <textarea id="resolve-note" rows="4"
                    style="width: 100%; padding: 0.8rem; border: 1px solid #e2e8f0; border-radius: 0.5rem; font-size: 1rem;"
                    placeholder="e.g. Pump deployed, drain cleared..."></textarea>
            </div>

            <div style="margin-bottom: 2.5rem;">
                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #334155;">Upload Proof
                    (Optional)</label>
                <div style="border: 2px dashed #cbd5e1; padding: 1.5rem; border-radius: 0.5rem; text-align: center; background: #f8fafc; cursor: pointer;"
                    onclick="document.getElementById('resolve-proof').click()">
                    <span style="display: block; color: #64748b; font-size: 0.9rem;">Click to upload image</span>
                    <input type="file" id="resolve-proof" accept="image/*" style="display: none;"
                        onchange="document.querySelector('#resolve-filename').textContent = this.files[0]?.name || ''">
                    <span id="resolve-filename"
                        style="display: block; color: var(--primary-blue); font-size: 0.85rem; margin-top: 0.5rem; font-weight: 600;"></span>
                </div>
            </div>

            <div style="display: flex; gap: 1rem;">
                <button onclick="closeResolveModal()" class="btn btn-outline"
                    style="flex: 1; border-color: #cbd5e1; color: #475569;">Cancel</button>
                <button onclick="submitResolution()" class="btn btn-success"
                    style="flex: 1; background: #16a34a; border: none; color: white; display: flex; align-items: center; justify-content: center; gap: 8px;">
                    Confirm Resolution
                </button>
            </div>
        </div>
    </div>


    <script src="navbar.js"></script>
    <script src="authority.js"></script>
</body>

</html>